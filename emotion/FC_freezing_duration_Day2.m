%%
clear; close all; clc;

%% 
freezing =[29.6666 47.2222 57.8888 55.7781 53.1107 46.6666 26.1118 28.4437 52.8897 35.5556 59 38.7766 37.7777 32.2222 59.8888 33.6666;
           63.5556 86.7778 36.4445 56.8889 52.5556 77 58.1105 38 60.3342 47.8879 66.4444 58.2234 56.8889 94.4444 68.3334 59.7762;
           60.3333 46.6668 89.1111 88.8885 91.556 76.3334 79.6667 47.6667 58.1112 94 53.6667 64.3322 85.5555 82.7791 66.5541 79.5571;
           4 47.0002 38.8886 39.6666 37.1116 59.6661 47.5562 51.4445 73 79.8889 74.8889 99.2222 100 100 60.2208 58.5571;
           63 96.1111 78.1111 77 75.6667 94 96.7778 84.5556 78.2222 52 54.2223 50.2223 51.7765 34.3333 39.4459 86.1111;
           39.4444 24.1113 49.222 23.4444 40.5555 57.8894 50.4445 46.3326 33.3342 36.6657 34.7788 56.2211 23.1124 29.7765 23.1126 37.6667;
           59.7778 88.7776 85.6669 73.8889 87.1111 70.2217 35.0007 98.2222 75.8897 88.5556 65 82.2222 65.8889 57.3334 74.3334 64.4429;
           60.6667 59.5554 44.8888 75.6666 68.0004 82.2222 38.5549 42.8896 81.1111 60.5556 40.2212 63.1122 47.8876 56.8888 69.557 67.4429];

figure
hold on

for k = 1:size(freezing,1)
    plot(1:16,freezing(k,:),'marker','o','markersize',4,...
        'markeredgecolor',[0.75 0.75 0.75],'markerfacecolor',[0.75 0.75 0.75],...
        'linestyle','-','color',[0.75 0.75 0.75 0.9],'linewidth',3);
end

[S,M] = std(freezing);
SEM = S/sqrt(8);
errorbar(1:16, M, SEM, "Color","black",'LineWidth',3);
plot(1:16, M,'o-','color','k','linewidth',4,'markeredgecolor','k','markerfacecolor','k','markersize',4);

xticks(2:2:16)
xticklabels({'1min','2min','3min','4min','5min','6min','7min','8min'})

% ylim([0 100])
% xlim([0.5 3.5])

ylabel('Freezing Duration (%)','FontSize',20,'FontWeight','bold');

title({'Freezing on the Context day',''},'FontSize',24,'FontWeight','bold')

ax = gca;
ax.LineWidth = 1.2;
ax.FontSize = 15;
ax.FontWeight = 'bold';

hold off

% [h1, p1, ci1, stats1] = ttest(freezing(:,1), freezing(:,2))
% 
% [h2, p2, ci2, stats2] = ttest(freezing(:,2), freezing(:,3))
