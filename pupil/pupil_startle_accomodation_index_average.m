clc
clear
close all

%%

% control_1_fed = [47.9843322791955 4.20096872512666 19.9184523765474 12.6581450315308 15.0463819904687 32.1055719182877 3.15875858928652 8.62856676843964];
% control_2_fed = [2.34411294456522 4.59556542627106 5.51516710469137 3.06245282498817 62.3833599849755 22.3668378411025 2.49325886133012 3.65499394809273];
% control_3_fed = [20.8570398136054 2.30970924311498 16.3533455489879 4.87201936336938 10.7856924082690 9.92299732277647 12.1178546337012 14.0948926305449];
% control_fed = 100*(1-(control_2_fed./control_1_fed + control_3_fed./control_2_fed)/2);
% 
% control_1_fasted = [6.09342311967252 2.18405040680556 6.72800891184088 1.76882676651639 11.1964246538586 7.68305336606695 11.3830252307550 6.96811075047674];
% control_2_fasted = [2.78070122729320 2.83919171484524 2.10939232801022 7.91666697417231 2.20115431167324 20.0673126644975 1.63087203016732 10.4740296613313];
% control_3_fasted = [13.5500919299757 3.26833916803950 13.6686436596926 1.49722540215591 3.93381372956307 3.73825586704756 21.8089610504578 6.07509342214873];
% control_fasted = 100*(1-(control_2_fasted./control_1_fasted + control_3_fasted./control_2_fasted)/2);
% 
% DTR_1_fed = [3.78098483230931 4.84170689805768 34.1558983772777 61.3866842426069 3.20486335357178 17.0132910730457 5.12237806754393 4.27265975818183 1.35529913199581 6.18598057728470];
% DTR_2_fed = [3.27255780968475 1.79707871052744 14.5994502930115 3.09229567057650 31.3753366520275 2.71619885350301 27.0551141371480 14.7080077548453 2.29144651210270 11.5714751054809];
% DTR_3_fed = [15.5824583885386 3.61180897290143 13.5225990630227 43.9325555059794 20.9598770423607 46.7307108710664 8.08378464246737 7.12495052626255 4.45582039878531 3.26544305861575];
% DTR_fed = 100*(1-(DTR_2_fed./DTR_1_fed + DTR_3_fed./DTR_2_fed)/2);
% 
% DTR_1_fasted = [2.76261334541839 3.94253348129864 67.2075460918329 15.9859169675397 12.9804755369844 4.24697532693141 6.92001679977344 1.92141318880928 42.1970239019347 32.2678107244943];
% DTR_2_fasted = [13.6257513326008 13.4344082442371 2.22452721885356 2.14982936864751 13.3673674145749 2.56278180856518 3.85491700963891 1.67829584169391 4.37670052392929 5.15965320596316];
% DTR_3_fasted = [6.52124619627728 6.19706100138629 14.1217871858717 13.8913572611551 2.19905043065793 2.18140976611713 8.75511880703361 2.63225821349482 10.6747087105542 2.37935100919750];
% DTR_fasted = 100*(1-(DTR_2_fasted./DTR_1_fasted + DTR_3_fasted./DTR_2_fasted)/2);

% control_1_fed = [778.914805546978 532.379165909244 203.832513577767 376.995198762903 546.423029958619 727.142756902875 313.107021779941 602.415098192923];
% control_2_fed = [500.253102634041 395.630590860092 203.384915002703 372.741055694416 702.633330147126 813.256995450112 343.730918852442 360.640797193312];
% control_3_fed = [519.716352000238 409.954188385482 178.204625427394 315.564351330572 347.814129507533 808.013932732999 294.269609258416 180];
% control_fed = 100*(1-(control_2_fed./control_1_fed + control_3_fed./control_2_fed)/2);
% 
% control_1_fasted = [502.052937074031 219.372257501459 396.385877774945 705.317602760243 391.004645833350 286.135212844551 459.879902480112 456.583644623548];
% control_2_fasted = [493.844969332177 167.529486502394 498.146698347291 481.188381305411 565.602444397203 344.629276591168 489.941603727082 249.397841004775];
% control_3_fasted = [622.178238007368 290.973374909612 519.243009254722 755.686556289842 322.078461758944 253.078605816068 457.926072178173 514.417900274977];
% control_fasted = 100*(1-(control_2_fasted./control_1_fasted + control_3_fasted./control_2_fasted)/2);
% 
% DTR_1_fed = [379.853361631564 945.901638910886 325.844853542848 235.473649176551 193.329525087603 340 266.529480600289 854.737650819900 810.763919218583 458.204333712044];
% DTR_2_fed = [295.332368983826 797.820360480423 249.286397770722 186.672838254023 141.183340236162 334.831768027230 133 100.90623785023 400 374.691346286713];
% DTR_3_fed = [272.229715003434 802.461215556110 200 169.534007303217 140 332.258402385418 200 100 685.848756122732 661.338744170815];
% DTR_fed = 100*(1-(DTR_2_fed./DTR_1_fed + DTR_3_fed./DTR_2_fed)/2);
% 
% DTR_1_fasted = [441.084396963397 816.802377586036 232.767852073564 207.791863101309 182.406423724053 474.930990917075 229.540823591941 562.191681559233 622.467240434743 445.427579765334];
% DTR_2_fasted = [372.264842425268 790.727500213140 200 206.163492682010 152.989645016070 322.063431574015 214.766027731022 240.553200224713 403.356686883245 351.338247352284];
% DTR_3_fasted = [264.285449673685 677.164876380649 200 200 221.826532101545 150 232.851895958873 442.227170254511 431.409161872561 325.872909601701];
% DTR_fasted = 100*(1-(DTR_2_fasted./DTR_1_fasted + DTR_3_fasted./DTR_2_fasted)/2);

control_1_fed = [4.080 2.260 2.193 1.426 2.162 3.188 2.081 3.310];
control_2_fed = [0.762 1.271 1.801 0.704 3.713 3.932 2.243 1.049];
control_3_fed = [0.230 1.276 1.361 0.437 0.556 3.389 1.625 0.786];
control_fed = 100*(1-(control_2_fed./control_1_fed + control_3_fed./control_2_fed)/2);

control_1_fasted = [2.375 0.575 0.822 0.498 2.046 0.361 1.977 2.269];
control_2_fasted = [1.157 -0.495 0.878 0.487 2.889 -0.496 2.083 0.080];
control_3_fasted = [4.281 0.901 1.994 3.044 0.885 0.060 1.840 3.926];
control_fasted = 100*(1-(control_2_fasted./control_1_fasted + control_3_fasted./control_2_fasted)/2);

DTR_1_fed = [3.847 2.523 2.861 5.162 2.065 2.824 2.779 2.135 2.564 2.276];
DTR_2_fed = [1.935 1.625 1.683 3.298 1.207 2.822 0.917 -0.051 0.886 1.310];
DTR_3_fed = [1.771 1.559 1.033 2.667 1.431 2.322 1.813 0.258 1.487 3.598];
DTR_fed = 100*(1-(DTR_2_fed./DTR_1_fed + DTR_3_fed./DTR_2_fed)/2);

DTR_1_fasted = [2.670 3.054 1.683 0.890 1.718 4.668 0.808 4.153 2.511 1.287];
DTR_2_fasted = [1.940 2.407 1.688 2.344 0.682 0.857 0.547 1.372 0.722 0.551];
DTR_3_fasted = [0.606 2.089 1.747 1.301 2.091 0.335 0.825 2.770 1.008 -0.136];
DTR_fasted = 100*(1-(DTR_2_fasted./DTR_1_fasted + DTR_3_fasted./DTR_2_fasted)/2);

%%

figure;
hold on

control = [control_fed' control_fasted'];
DTR = [DTR_fed' DTR_fasted'];

model_series = [mean(DTR_fed) mean(DTR_fasted); mean(control_fed) mean(control_fasted)];
model_error = [std(DTR_fed)/sqrt(10) std(DTR_fasted)/sqrt(10); std(control_fed)/sqrt(8) std(control_fasted)/sqrt(8)];

b = bar(model_series,'linewidth',3);
b(1).FaceColor = '#C6D6EA';
b(2).FaceColor = '#719DC9';

for k = 1:size(DTR,1)
    plot([0.8571, 1.1429],DTR(k,:),'marker','o','markersize',2,...
        'markeredgecolor',[0.75 0.75 0.75],'markerfacecolor',[0.75 0.75 0.75],...
        'linestyle','-','color',[0.75 0.75 0.75 0.9],'linewidth',3);
end

for k = 1:size(control,1)
    plot([1.8571, 2.1429],control(k,:),'marker','o','markersize',2,...
        'markeredgecolor',[0.75 0.75 0.75],'markerfacecolor',[0.75 0.75 0.75],...
        'linestyle','-','color',[0.75 0.75 0.75 0.9],'linewidth',3);
end

errorbar([0.8571 1.1429; 1.8571 2.1429],model_series,model_error,'k','linestyle','none','linewidth',3,'CapSize',15);

ax = gca;
ax.LineWidth = 2;
ax.FontSize = 15;
ax.FontWeight = 'bold';

ylabel('AI (%)','FontSize',15,'FontWeight','bold');
title({'Accomodation Index',''},'FontSize',20,'FontWeight','bold','color','k')

xticks([1 2])
xticklabels({'DTR+','DTR-'})

ylim([-610 240])

%%

[h_HR_1, p_HR_1, ci_HR_1, stats_HR_1] = ttest2(DTR_fed, DTR_fasted)

[h_HR_2, p_HR_2, ci_HR_2, stats_HR_2] = ttest2(control_fed, control_fasted)

[h_HR_3, p_HR_3, ci_HR_3, stats_HR_3] = ttest2(DTR_fed,control_fed)

[h_HR_4, p_HR_4, ci_HR_4, stats_HR_4] = ttest2(DTR_fasted,control_fasted)


